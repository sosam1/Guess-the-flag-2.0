countries = [ { "abbr": "af", "name": "afganistán" }, { "abbr": "ax", "name": "islas de åland" }, { "abbr": "al", "name": "albania" }, { "abbr": "dz", "name": "argelia" }, { "abbr": "as", "name": "samoa americana" }, { "abbr": "ad", "name": "andorra" }, { "abbr": "ao", "name": "angola" }, { "abbr": "ai", "name": "anguila" }, { "abbr": "aq", "name": "antártida" }, { "abbr": "ag", "name": "antigua y barbuda" }, { "abbr": "ar", "name": "argentina" }, { "abbr": "am", "name": "armenia" }, { "abbr": "aw", "name": "aruba" }, { "abbr": "au", "name": "australia" }, { "abbr": "at", "name": "austria" }, { "abbr": "az", "name": "azerbaiyán" }, { "abbr": "bs", "name": "bahamas" }, { "abbr": "bh", "name": "baréin" }, { "abbr": "bd", "name": "bangladesh" }, { "abbr": "bb", "name": "barbados" }, { "abbr": "by", "name": "bielorrusia" }, { "abbr": "be", "name": "bélgica" }, { "abbr": "bz", "name": "belice" }, { "abbr": "bj", "name": "benín" }, { "abbr": "bm", "name": "bermuda" }, { "abbr": "bt", "name": "bután" }, { "abbr": "bo", "name": "bolivia" }, { "abbr": "ba", "name": "bosnia y herzegovina" }, { "abbr": "bw", "name": "botsuana" }, { "abbr": "bv", "name": "isla bouvet" }, { "abbr": "br", "name": "brasil" }, { "abbr": "io", "name": "territorio británico del océano índico" }, { "abbr": "vg", "name": "islas vírgenes británicas" }, { "abbr": "bn", "name": "brunei" }, { "abbr": "bg", "name": "bulgaria" }, { "abbr": "bf", "name": "burkina faso" }, { "abbr": "bi", "name": "burundi" }, { "abbr": "kh", "name": "camboya" }, { "abbr": "cm", "name": "camerún" }, { "abbr": "ca", "name": "canadá" }, { "abbr": "cv", "name": "cabo verde" }, { "abbr": "ky", "name": "islas caimán" }, { "abbr": "cf", "name": "república de áfrica central" }, { "abbr": "td", "name": "chad" }, { "abbr": "cl", "name": "chile" }, { "abbr": "cn", "name": "china" }, { "abbr": "cx", "name": "isla de pascua" }, { "abbr": "cc", "name": "islas cocos" }, { "abbr": "co", "name": "colombia" }, { "abbr": "km", "name": "comoras" }, { "abbr": "ck", "name": "islas cook" }, { "abbr": "cr", "name": "costa rica" }, { "abbr": "hr", "name": "croacia" }, { "abbr": "cu", "name": "cuba" }, { "abbr": "cw", "name": "curazao" }, { "abbr": "cy", "name": "chipre" }, { "abbr": "cz", "name": "república checa" }, { "abbr": "cd", "name": "república democrática del congo" }, { "abbr": "dk", "name": "dinamarca" }, { "abbr": "dj", "name": "yibuti" }, { "abbr": "dm", "name": "dominica" }, { "abbr": "do", "name": "república dominicana" }, { "abbr": "tl", "name": "timor oriental" }, { "abbr": "ec", "name": "ecuador" }, { "abbr": "eg", "name": "egipto" }, { "abbr": "sv", "name": "el salvador" }, { "abbr": "gq", "name": "guinea ecuatorial" }, { "abbr": "er", "name": "eritrea" }, { "abbr": "ee", "name": "estonia" }, { "abbr": "et", "name": "etiopía" }, { "abbr": "fk", "name": "islas malvinas" }, { "abbr": "fo", "name": "islas faroe" }, { "abbr": "fj", "name": "fiji" }, { "abbr": "fi", "name": "finlandia" }, { "abbr": "fr", "name": "francia" }, { "abbr": "gf", "name": "guayana francesa" }, { "abbr": "pf", "name": "polinesia francesa" }, { "abbr": "tf", "name": "territorios del sur franceses" }, { "abbr": "ga", "name": "gabón" }, { "abbr": "gm", "name": "gambia" }, { "abbr": "ge", "name": "georgia" }, { "abbr": "de", "name": "alemania" }, { "abbr": "gh", "name": "ghana" }, { "abbr": "gi", "name": "gibraltar" }, { "abbr": "gr", "name": "grecia" }, { "abbr": "gl", "name": "groenlandia" }, { "abbr": "gd", "name": "granada" }, { "abbr": "gp", "name": "guadalupe" }, { "abbr": "gu", "name": "guam" }, { "abbr": "gt", "name": "guatemala" }, { "abbr": "gg", "name": "guernsey" }, { "abbr": "gn", "name": "guinea" }, { "abbr": "gw", "name": "guinea bissau" }, { "abbr": "gy", "name": "guyana" }, { "abbr": "ht", "name": "haití" }, { "abbr": "hn", "name": "honduras" }, { "abbr": "hk", "name": "hong kong" }, { "abbr": "hu", "name": "hungría" }, { "abbr": "is", "name": "islandia" }, { "abbr": "in", "name": "india" }, { "abbr": "id", "name": "indonesia" }, { "abbr": "ir", "name": "irán" }, { "abbr": "iq", "name": "irak" }, { "abbr": "ie", "name": "irlanda" }, { "abbr": "im", "name": "isla de man" }, { "abbr": "il", "name": "israel" }, { "abbr": "it", "name": "italia" }, { "abbr": "ci", "name": "costa de marfil" }, { "abbr": "jm", "name": "jamaica" }, { "abbr": "jp", "name": "japón" }, { "abbr": "jo", "name": "jordania" }, { "abbr": "kz", "name": "kazajistán" }, { "abbr": "ke", "name": "kenia" }, { "abbr": "ki", "name": "kiribati" }, { "abbr": "xk", "name": "kosovo" }, { "abbr": "kw", "name": "kuwait" }, { "abbr": "kg", "name": "kirguistán" }, { "abbr": "la", "name": "laos" }, { "abbr": "lv", "name": "letonia" }, { "abbr": "lb", "name": "líbano" }, { "abbr": "ls", "name": "lesoto" }, { "abbr": "lr", "name": "liberia" }, { "abbr": "ly", "name": "libia" }, { "abbr": "li", "name": "liechtenstein" }, { "abbr": "lt", "name": "lituania" }, { "abbr": "lu", "name": "luxemburgo" }, { "abbr": "mo", "name": "macao" }, { "abbr": "mk", "name": "macedonia" }, { "abbr": "mg", "name": "madagascar" }, { "abbr": "mw", "name": "malaui" }, { "abbr": "my", "name": "malasia" }, { "abbr": "mv", "name": "maldivas" }, { "abbr": "ml", "name": "malí" }, { "abbr": "mt", "name": "malta" }, { "abbr": "mh", "name": "islas marshall" }, { "abbr": "mq", "name": "martinica" }, { "abbr": "mr", "name": "mauritania" }, { "abbr": "mu", "name": "mauricio" }, { "abbr": "yt", "name": "mayotte" }, { "abbr": "mx", "name": "méxico" }, { "abbr": "fm", "name": "micronesia" }, { "abbr": "md", "name": "moldavia" }, { "abbr": "mc", "name": "mónaco" }, { "abbr": "mn", "name": "mongolia" }, { "abbr": "me", "name": "montenegro" }, { "abbr": "ms", "name": "montserrat" }, { "abbr": "ma", "name": "marruecos" }, { "abbr": "mz", "name": "mozambique" }, { "abbr": "mm", "name": "myanmar" }, { "abbr": "na", "name": "namibia" }, { "abbr": "nr", "name": "nauru" }, { "abbr": "np", "name": "nepal" }, { "abbr": "nl", "name": "países bajos" }, { "abbr": "nc", "name": "nueva caledonia" }, { "abbr": "nz", "name": "nueva zelanda" }, { "abbr": "ni", "name": "nicaragua" }, { "abbr": "ne", "name": "níger" }, { "abbr": "ng", "name": "nigeria" }, { "abbr": "nu", "name": "niue" }, { "abbr": "nf", "name": "isla norfolk" }, { "abbr": "kp", "name": "corea del norte" }, { "abbr": "no", "name": "noruega" }, { "abbr": "om", "name": "omán" }, { "abbr": "pk", "name": "pakistán" }, { "abbr": "pw", "name": "palaos" }, { "abbr": "ps", "name": "palestina" }, { "abbr": "pa", "name": "panamá" }, { "abbr": "pg", "name": "papúa nueva guinea" }, { "abbr": "py", "name": "paraguay" }, { "abbr": "pe", "name": "perú" }, { "abbr": "ph", "name": "filipinas" }, { "abbr": "pn", "name": "islas pitcairn" }, { "abbr": "pl", "name": "polonia" }, { "abbr": "pt", "name": "portugal" }, { "abbr": "pr", "name": "puerto rico" }, { "abbr": "qa", "name": "catar" }, { "abbr": "cg", "name": "república del congo" }, { "abbr": "re", "name": "reunión" }, { "abbr": "ro", "name": "rumanía" }, { "abbr": "ru", "name": "rusia" }, { "abbr": "rw", "name": "ruanda" }, { "abbr": "bl", "name": "san bartolomé" }, { "abbr": "sh", "name": "santa elena" }, { "abbr": "kn", "name": "san cristóbal y nieves" }, { "abbr": "lc", "name": "santa lucía" }, { "abbr": "pm", "name": "san pedro y miguelón" }, { "abbr": "vc", "name": "san vicente y las granadinas" }, { "abbr": "ws", "name": "samoa occidental" }, { "abbr": "sm", "name": "san marino" }, { "abbr": "st", "name": "santo tomé y príncipe" }, { "abbr": "sa", "name": "arabia saudita" }, { "abbr": "sn", "name": "senegal" }, { "abbr": "rs", "name": "serbia" }, { "abbr": "sl", "name": "sierra leona" }, { "abbr": "sg", "name": "singapur" }, { "abbr": "sx", "name": "san martín" }, { "abbr": "sk", "name": "eslovaquia" }, { "abbr": "si", "name": "eslovenia" }, { "abbr": "sb", "name": "islas salomón" }, { "abbr": "so", "name": "somalia" }, { "abbr": "za", "name": "sudáfrica" }, { "abbr": "kr", "name": "corea del sur" }, { "abbr": "ss", "name": "sudán del sur" }, { "abbr": "es", "name": "españa" }, { "abbr": "lk", "name": "sri lanka" }, { "abbr": "sd", "name": "sudán" }, { "abbr": "sr", "name": "surinam" }, { "abbr": "sj", "name": "islas svalbard y jan mayen" }, { "abbr": "sz", "name": "suazilandia" }, { "abbr": "se", "name": "suecia" }, { "abbr": "ch", "name": "suiza" }, { "abbr": "sy", "name": "siria" }, { "abbr": "tw", "name": "taiwán" }, { "abbr": "tj", "name": "tayikistán" }, { "abbr": "tz", "name": "tanzania" }, { "abbr": "th", "name": "tailandia" }, { "abbr": "tg", "name": "república togolesa" }, { "abbr": "tk", "name": "islas tokelau" }, { "abbr": "to", "name": "tonga" }, { "abbr": "tt", "name": "trinidad y tobago" }, { "abbr": "tn", "name": "túnez" }, { "abbr": "tr", "name": "turquía" }, { "abbr": "tm", "name": "turkmenistán" }, { "abbr": "tc", "name": "islas turcos y caicos" }, { "abbr": "tv", "name": "tuvalu" }, { "abbr": "vi", "name": "islas vírgenes de los ee.uu." }, { "abbr": "ug", "name": "uganda" }, { "abbr": "ua", "name": "ucrania" }, { "abbr": "ae", "name": "emiratos árabes unidos" }, { "abbr": "gb", "name": "reino unido" }, { "abbr": "us", "name": "estados unidos" }, { "abbr": "uy", "name": "uruguay" }, { "abbr": "uz", "name": "uzbekistán" }, { "abbr": "vu", "name": "vanuatu" }, { "abbr": "va", "name": "vaticano" }, { "abbr": "ve", "name": "venezuela" }, { "abbr": "vn", "name": "vietnam" }, { "abbr": "wf", "name": "wallis y futuna" }, { "abbr": "eh", "name": "sahara occidental" }, { "abbr": "ye", "name": "yemen" }, { "abbr": "zm", "name": "zambia" }, { "abbr": "zw", "name": "zimbabue" },];


function logicaDelJuego(modoDeJuego){

//con esto es mas facil leer la bandera al azar. toma como parametro la abreviacion(abbr) de la bandera y la usa en la URL
let url = (flag) => { return `https://flagcdn.com/w320/${flag}.png` };

//funcion que saca tildes para comparar respuestas
function sacarTildes(str){
    return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
  } 

pais_al_azar = countries[Math.floor(Math.random() * countries.length)];

//usamos la variable url con el parametro
document.getElementById('flag-img').src = url(pais_al_azar.abbr)

////Aca empieza la logica a partir de la respuesta ////

let input_respuesta = document.getElementById("input-respuesta")
let boton_respuesta = document.getElementById("btnRespuesta")
let msj_container = document.getElementById("mensaje-container")

let contador_de_banderas = document.getElementById("contador-de-banderas") // muestra cuantas banderas se van respondiendo
let cuenta_banderas = 0 //empieza siendo 0 y suma 1 cada vez que clickean el boton de respuesta
contador_de_banderas.innerHTML = `${cuenta_banderas} / ${modoDeJuego}`

let score = document.getElementById("score") //para marcar las correctas

function reiniciar(){
    setTimeout(function () {
    pais_al_azar = countries[Math.floor(Math.random() * countries.length)];
    document.getElementById('flag-img').src = url(pais_al_azar.abbr)
    msj_container.innerHTML = ""
    input_respuesta.value = ""
    //lo de abajo es mas comodo que este aca para que no spameen el click
    cuenta_banderas++;
    contador_de_banderas.innerHTML = `${cuenta_banderas} / ${modoDeJuego}`
  }, 1500);
}

let correctas = 0
let incorrectas = 0
let x =1

boton_respuesta.addEventListener("click", function(e){

    e.preventDefault()
    x++
    //uso la funcion sacar tildes del principio

    respuesta_del_usuario = sacarTildes(input_respuesta.value)
    
    nombre_pais_correcto = sacarTildes(pais_al_azar.name)

    if(respuesta_del_usuario.toLowerCase() == nombre_pais_correcto.toLowerCase()){

        msj_container.innerHTML = `
        
        <div class="alert alert-success" role="alert">
            Excelente! Sigue asi
        </div>
        
        `

        correctas++;
        localStorage.setItem("puntuacion", correctas)

        score.innerHTML = `
        
        puntuación: ${correctas}
        
        `
        numero += 5
    } else{
        msj_container.innerHTML = `
        
        <div class="alert alert-danger" role="alert">
            Error, El país era ${pais_al_azar.name}
        </div>

        `
        incorrectas++;
    }

    if(correctas + incorrectas > modoDeJuego){
        setTimeout(function () {
            window.location.href = "puntuacion.html"
          }, 1000);

    }else{
        reiniciar()
    }

    //caso random que un enfermo lo pase 100000 veces
    if(incorrectas > 0 && modoDeJuego == 100000){
        setTimeout(function () {
            window.location.href = "puntuacion.html"
          }, 1000);
    }
    
})

}

let modoDeJuego = localStorage.getItem("modo de juego")
console.log(modoDeJuego)

////timmer para contrareloj///
let numero = 10
let timmer = document.getElementById("timmer-container")

function conteo(){
    timmer.innerHTML = numero
    numero--
    if(numero == 0){
        clearInterval()
        window.location.href = "puntuacion.html"
    }
    if(numero < 10){
        timmer.style.color = "#ff0000"
    }
}



switch (modoDeJuego) {

    case "20":
            console.log("llego")
            logicaDelJuego(modoDeJuego)
            break

    case "50":
            console.log("llego")
            logicaDelJuego(modoDeJuego)
            break

    case "100":
            console.log("llego")
            logicaDelJuego(modoDeJuego)
            break

    case "100000":
            console.log("llego")
            logicaDelJuego(100000)
            break
    case "contrareloj":
            logicaDelJuego("ထ")
            let temporizador = setInterval(() =>{
                conteo()
            }, 1000)
            break
    
}